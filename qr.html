<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Pedido de Comida</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 2em;
        background: #f9f9f9;
      }
      .card {
        background: white;
        padding: 1.5em;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        max-width: 400px;
        margin: auto;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h2>Detalle del Pedido</h2>
      <p id="info">Cargando datos...</p>
    </div>

    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const cedula = urlParams.get("cedula");

      const sheetUrl = "https://docs.google.com/spreadsheets/d/1Apfz0KugvEMqks7jVsby1VCOUC-MW8k_d2YxlpRbRkc/gviz/tq?tqx=out:json&sheet=Entrada";

      fetch(sheetUrl)
        .then(res => res.text())
        .then(text => {
          const jsonText = text.match(/google\.visualization\.Query\.setResponse\((.*)\);/s)[1];
          const data = JSON.parse(jsonText);
          const rows = data.table.rows;

          // Filtrar por cédula
          const result = rows.reverse().find(row => row.c[2] && row.c[2].f === cedula);
          
          if (result) {
            const nombre = result.c[1]?.v || "Sin nombre";
            const producto = result.c[3]?.v || "Sin producto";
            const precio = result.c[4]?.f || "Sin precio";
            const fecha = result.c[0]?.f || "Sin fecha";

            document.getElementById("info").innerHTML = `
              <strong>Nombre:</strong> ${nombre}<br>
              <strong>Cédula:</strong> ${cedula}<br>
              <strong>Producto:</strong> ${producto}<br>
              <strong>Precio:</strong> ${precio}<br>
              <strong>Fecha:</strong> ${fecha}
            `;
          } else {
            document.getElementById("info").innerText = "No se encontró el pedido.";
          }
        })
        .catch(err => {
          console.error("Error al cargar datos:", err);
          document.getElementById("info").innerText = "Error al cargar los datos.";
        });
    </script>
  </body>
</html>
